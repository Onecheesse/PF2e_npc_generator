<!DOCTYPE html>
<html lang="cs" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starfinder Pomocn√≠ƒçek v1.10</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: #0c1117; 
            color: #cdd6f4;
        }
        h1, h2, h3, h4, h5, h6 { 
            font-family: 'Orbitron', sans-serif;
            color: #89b4fa;
            text-shadow: 0 0 5px rgba(137, 180, 250, 0.5);
        }
        .data-panel { 
            background-color: rgba(17, 24, 39, 0.8); 
            border: 1px solid #3b82f6;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
            display: flex;
            flex-direction: column;
        }
        .tab-button { 
            transition: all 0.3s ease; 
            border-bottom: 3px solid transparent; 
            padding: 0.75rem 0.5rem;
            white-space: nowrap;
            color: #9399b2;
        }
        .tab-button.active, .tab-button:hover { 
            border-bottom-color: #89b4fa; 
            color: #f5c2e7; 
            text-shadow: 0 0 8px rgba(245, 194, 231, 0.7);
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card-expand { max-height: 0; overflow: hidden; transition: max-height 0.7s ease-in-out; }
        .card-expand.open { max-height: 4000px; }
        
        .card-header .expand-btn {
            color: #89b4fa;
            transition: transform 0.3s ease-in-out;
        }
        .card-header.open .expand-btn {
            transform: rotate(45deg);
        }
        
        .gen-button {
            background-color: #f5c2e7;
            color: #1e1e2e;
            padding: 0.5rem 1.25rem;
            border-radius: 9999px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(245, 194, 231, 0.5);
            cursor: pointer;
        }
        .gen-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(245, 194, 231, 0.8);
        }
        .gen-button:disabled {
            background-color: #45475a;
            color: #6c7086;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        select, .gen-output, input {
             background-color: #1e1e2e;
             border: 1px solid #45475a;
             color: #cdd6f4;
             border-radius: 8px;
        }
        .gen-output { flex-grow: 1; }
        .gen-output h4 { color: #f5c2e7; text-shadow: none; font-family: 'Orbitron', sans-serif;}
        .gen-output ul { margin-left: 1rem; list-style-type: disc; }
        .history-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.5rem;
            padding: 0.25rem 0;
        }
        .history-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #89b4fa;
            transition: color 0.2s;
        }
        .history-btn:hover:not(:disabled) { color: #f5c2e7; }
        .history-btn:disabled { color: #45475a; cursor: not-allowed; }

        .save-btn {
            background-color: #3b82f6;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: bold;
            transition: background-color 0.2s;
            margin-left: auto;
        }
        .save-btn:hover { background-color: #60a5fa; }

        .card {
            background-color: rgba(30, 30, 46, 0.7);
            border: 1px solid #45475a;
            transition: all 0.3s ease;
        }
        .card:hover {
            border-color: #89b4fa;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(137, 180, 250, 0.1);
        }
        .feat {
            background-color: rgba(17, 24, 39, 0.6);
            border-left: 3px solid #f5c2e7;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            border-radius: 0 8px 8px 0;
        }
        .spinner {
            border: 4px solid rgba(205, 214, 244, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #f5c2e7;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #11111b; }
        ::-webkit-scrollbar-thumb { background: #45475a; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6c7086; }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <header class="bg-gray-900/80 sticky top-0 z-40 backdrop-filter backdrop-blur-lg border-b border-blue-500/30">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-2xl md:text-3xl font-bold">Starfinder Pomocn√≠ƒçek</h1>
        </nav>
    </header>

    <main class="container mx-auto px-4 md:px-6 py-8">
        
        <div class="border-b-2 border-blue-500/30 mb-8">
            <nav id="tabs" class="flex flex-wrap space-x-2 md:space-x-6 -mb-0.5 overflow-x-auto">
                <button data-tab="generators-tab" class="tab-button active">üöÄ Gener√°tory</button>
                <button data-tab="archetypes-tab" class="tab-button">üèÖ Archetypy</button>
                <button data-tab="adventures-tab" class="tab-button">üåå Dobrodru≈æstv√≠</button>
                <button data-tab="locations-tab" class="tab-button">ü™ê Lokace</button>
                <button data-tab="factions-tab" class="tab-button">üèõÔ∏è Frakce</button>
                <button data-tab="ancestries-tab" class="tab-button">üëΩ Rasy</button>
                <button data-tab="classes-tab" class="tab-button">üßë‚ÄçüöÄ Povol√°n√≠</button>
            </nav>
        </div>

        <div id="tab-contents">
            <!-- Generators Tab -->
            <div id="generators-tab" class="tab-content active">
                <h2 class="text-3xl font-bold mb-6 text-center">Centrum Kreativn√≠ch Gener√°tor≈Ø</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    
                    <!-- Adventure Hook Generator -->
                    <div class="data-panel p-6 rounded-lg">
                        <h3 class="text-2xl mb-4">N√°mƒõt na Dobrodru≈æstv√≠</h3>
                        <p class="text-sm text-gray-400 mb-4">Vyberte typ a p≈ôidejte vlastn√≠ n√°pady pro z√°pletku na m√≠ru.</p>
                        <select id="adventure-type-select" class="w-full p-2 mb-2">
                            <!-- Options populated by JS -->
                        </select>
                        <input type="text" id="adventure-context-input" placeholder="Voliteln√Ω n√°mƒõt (nap≈ô. 'opu≈°tƒõn√° tƒõ≈æa≈ôsk√° loƒè')" class="w-full p-2 mb-4">
                        <button id="generate-adventure-hook" class="gen-button w-full">Generovat N√°mƒõt</button>
                        <div id="adventure-output" class="gen-output mt-4 p-4 min-h-[200px] border-dashed text-sm"></div>
                        <div class="history-nav">
                            <button id="adventure-prev" class="history-btn" disabled>&lt;</button>
                            <span id="adventure-history-counter" class="text-xs">0 / 0</span>
                            <button id="adventure-next" class="history-btn" disabled>&gt;</button>
                            <button id="save-adventure-btn" class="save-btn">Ulo≈æit</button>
                        </div>
                    </div>

                    <!-- NPC Generator -->
                    <div class="data-panel p-6 rounded-lg">
                        <h3 class="text-2xl mb-4">Postava (NPC)</h3>
                        <p class="text-sm text-gray-400 mb-4">Pot≈ôebujete rychle postavu? Zadejte roli, frakci, nebo lokaci.</p>
                        <input type="text" id="npc-context-input" placeholder="nap≈ô. 'cynick√Ω Steward', 'pir√°t z Diaspory'" class="w-full p-2 mb-4">
                        <button id="generate-npc" class="gen-button w-full">Generovat NPC</button>
                        <div id="npc-output" class="gen-output mt-4 p-4 min-h-[200px] border-dashed text-sm"></div>
                         <div class="history-nav">
                            <button id="npc-prev" class="history-btn" disabled>&lt;</button>
                            <span id="npc-history-counter" class="text-xs">0 / 0</span>
                            <button id="npc-next" class="history-btn" disabled>&gt;</button>
                            <button id="save-npc-btn" class="save-btn">Ulo≈æit</button>
                        </div>
                    </div>

                    <!-- Starship Name Generator -->
                    <div class="data-panel p-6 rounded-lg">
                        <h3 class="text-2xl mb-4">Jm√©no Hvƒõzdn√© Lodi</h3>
                        <p class="text-sm text-gray-400 mb-4">Dejte sv√© lodi jm√©no a kr√°tkou historii.</p>
                        <select id="ship-type-select" class="w-full p-2 mb-2">
                             <option value="explorer">Pr≈Øzkumn√°</option>
                             <option value="freighter">N√°kladn√≠</option>
                             <option value="pirate">Piratsk√°</option>
                             <option value="military">Vojensk√°</option>
                             <option value="luxury">Luxusn√≠</option>
                             <option value="salvage">Z√°chrann√°/Sbƒõraƒçsk√°</option>
                        </select>
                         <input type="text" id="ship-context-input" placeholder="Voliteln√Ω n√°mƒõt (nap≈ô. 'pos√°dka z Vesku')" class="w-full p-2 mb-4">
                        <button id="generate-ship-name" class="gen-button w-full">Generovat Jm√©na</button>
                        <div id="ship-output" class="gen-output mt-4 p-4 min-h-[200px] border-dashed text-sm"></div>
                         <div class="history-nav">
                            <button id="ship-prev" class="history-btn" disabled>&lt;</button>
                            <span id="ship-history-counter" class="text-xs">0 / 0</span>
                            <button id="ship-next" class="history-btn" disabled>&gt;</button>
                            <button id="save-ship-btn" class="save-btn">Ulo≈æit</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Other Tabs Content Placeholder -->
            <div id="archetypes-tab" class="tab-content"></div>
            <div id="adventures-tab" class="tab-content"></div>
            <div id="locations-tab" class="tab-content"></div>
            <div id="factions-tab" class="tab-content"></div>
            <div id="ancestries-tab" class="tab-content"></div>
            <div id="classes-tab" class="tab-content"></div>
        </div>
    </main>

    <footer class="bg-gray-800/50 text-center p-6 mt-16 border-t-2 border-blue-500/30">
        <div class="container mx-auto px-6">
            <div id="api-key-section" class="max-w-md mx-auto text-sm">
                 <h3 class="text-xl font-bold mb-4">Nastaven√≠ API kl√≠ƒçe</h3>
                 <p class="mb-2 text-gray-400">Pro vyu≈æit√≠ generativn√≠ch funkc√≠ (AI) zadejte sv≈Øj vlastn√≠ Gemini API kl√≠ƒç. M≈Ø≈æete jej z√≠skat zdarma na <a href="https://aistudio.google.com/app/apikey" target="_blank" class="text-f5c2e7 hover:underline">Google AI Studio</a>.</p>
                 <div class="mb-4">
                     <label for="api-key-input" class="block font-bold mb-1">V√°≈° Gemini API kl√≠ƒç:</label>
                     <div class="flex gap-2">
                         <input type="password" id="api-key-input" class="w-full p-2" placeholder="Vlo≈æte sv≈Øj API kl√≠ƒç">
                         <button id="save-api-key-btn" class="gen-button">Ulo≈æit</button>
                     </div>
                     <p id="api-key-status" class="text-xs mt-2 h-4"></p>
                 </div>
            </div>
            <p class="text-xs text-gray-500 mt-4">Starfinder Pomocn√≠ƒçek v1.10 (Integrace Lore)</p>
        </div>
    </footer>

    <script>
    const starfinderData = {
        archetypes: [
            {
                name: "AbadarCorp Rep",
                source: "Galaxy Guide",
                description: "Z√°stupci AbadarCorp jsou v√≠ce ne≈æ jen obchodn√≠ci; jsou to agenti civilizace a obchodu, kte≈ô√≠ vyu≈æ√≠vaj√≠ sv√© znalosti byznysu a korpor√°tn√≠ch strategi√≠ k dosa≈æen√≠ sv√Ωch c√≠l≈Ø, a≈• u≈æ diplomaticky, nebo lst√≠. Jejich pr√°ce je ƒçasto smƒõsic√≠ diplomacie, ≈°pion√°≈æe a ekonomick√© v√°lky, v≈ædy pod rou≈°kou legitimn√≠ho obchodu.",
                feats: [
                    { name: "AbadarCorp Rep Dedication", level: 2, prerequisites: "Tr√©novan√Ω v Deception, Diplomacy, nebo Society.", text: "Z√≠sk√°≈° talent Additional Lore pro Business nebo Corporate Lore. Tuto dovednost m≈Ø≈æe≈° pou≈æ√≠t m√≠sto jak√©koli jin√© p≈ôi hodu na Recall Knowledge o t√©matech souvisej√≠c√≠ch s tvou prac√≠, jako jsou zbo≈æ√≠, klienti nebo pr≈Ømyslov√© z√°kony." },
                    { name: "According to My Calculations", level: 4, prerequisites: "AbadarCorp Rep Dedication", text: "Ozn√°m√≠≈° obchodn√≠ projekce spojenci. Hod√≠≈° na Business nebo Corporate Lore a p≈ôi √∫spƒõchu z√≠sk√° spojenec +1 bonus k dal≈°√≠mu hodu na dovednost nebo √∫tok (+2 p≈ôi kritick√©m √∫spƒõchu). C√≠l je v≈Øƒçi t√©to akci imunn√≠ na 24 hodin." },
                    { name: "Sales Pitch", level: 4, prerequisites: "AbadarCorp Rep Dedication", text: "M≈Ø≈æe≈° pou≈æ√≠t Business nebo Corporate Lore k akci Make an Impression. P≈ôi √∫spƒõchu zlep≈°√≠≈° postoj c√≠le o jeden stupe≈à. C√≠l je v≈Øƒçi t√©to akci imunn√≠ na 24 hodin." },
                    { name: "Corporate Speak", level: 4, prerequisites: "AbadarCorp Rep Dedication", text: "M≈Ø≈æe≈° sd√≠let tajn√© zpr√°vy pomoc√≠ korpor√°tn√≠ho ≈æargonu. Spojenci, kte≈ô√≠ s tebou cestuj√≠, nebo jsou tr√©novan√≠ ve stejn√©m Lore, ti rozum√≠ automaticky. Ostatn√≠ mus√≠ uspƒõt na hodu na Perception, aby si v≈°imli, ≈æe p≈ôed√°v√°≈° zpr√°vu." },
                    { name: "It's Who You Know", level: 5, prerequisites: "AbadarCorp Rep Dedication", text: "Vyu≈æ√≠v√°≈° svou s√≠≈• kontakt≈Ø. Akce Gather Information nebo Create a Forgery ti trvaj√≠ poloviƒçn√≠ dobu." },
                    { name: "Do You Know Who I Work For?", level: 7, prerequisites: "AbadarCorp Rep Dedication; expert v Intimidation", text: "P≈ôi pou≈æit√≠ Intimidation na Coerce nebo Demoralize proti c√≠li, kter√Ω zn√° tvou korporaci, se √∫spƒõch st√°v√° kritick√Ωm √∫spƒõchem." },
                    { name: "Maximize Profits", level: 7, prerequisites: "AbadarCorp Rep Dedication", text: "P≈ôi ne√∫spƒõchu na hodu Earn Income z√≠sk√°≈° m√≠sto toho √∫spƒõch." }
                ]
            },
            {
                name: "Space Pirate",
                source: "Galaxy Guide",
                description: "≈Ωije≈° ≈æivotem psance mezi hvƒõzdami, hled√°≈° ko≈ôist a sl√°vu. A≈• u≈æ jsi souƒç√°st√≠ pos√°dky Free Captains, nebo nez√°visl√Ω korz√°r, tv√© jm√©no je ≈°ept√°no v p≈ô√≠stavn√≠ch barech po cel√© galaxii. Pir√°ti si cen√≠ svobody, pos√°dky a samoz≈ôejmƒõ tuƒçn√©ho zisku.",
                feats: [
                    { name: "Space Pirate Dedication", level: 2, prerequisites: "Tr√©novan√Ω v Intimidation.", text: "Z√≠sk√°≈° tr√©nink (nebo expert√≠zu) v Piloting. Z√≠sk√°≈° obezn√°menost s cutlassy, flaily, rapiers a zbranƒõmi s vlastnost√≠ 'razing'. Z√≠sk√°≈° akci Holo-Roger, kter√° ti umo≈æn√≠ Demoralizovat v≈°echny nep≈ô√°tele v okol√≠, kdy≈æ hod√≠≈° iniciativu." },
                    { name: "Broadside Charge", level: 4, prerequisites: "Space Pirate Dedication", text: "Dr≈æ√≠≈° pistoli a seƒçnou zbra≈à. Umo≈æ≈àuje ti prov√©st √∫tok na d√°lku, pohyb a √∫tok na bl√≠zko jako dvƒõ akce proti jednomu c√≠li." },
                    { name: "Pirate's Parry", level: 6, prerequisites: "Space Pirate Dedication", text: "Jako reakci na √∫tok na bl√≠zko z√≠sk√°≈° +2 bonus k AC. P≈ôi kritick√©m ne√∫spƒõchu √∫toƒçn√≠ka m≈Ø≈æe≈° prov√©st proti√∫tok na d√°lku." },
                    { name: "Press-Gang the Soul", level: 8, prerequisites: "Space Pirate Dedication", text: "Kdy≈æ poraz√≠≈° nep≈ô√≠tele pomoc√≠ phase cutlass, ukradne≈° ƒç√°st jeho vitality a m≈Ø≈æe≈° na v≈Øli ses√≠lat kouzlo wisp ally." },
                    { name: "Dal≈°√≠ talenty", level: "4+", prerequisites: "R≈Øzn√©", text: "Tento archetyp tak√© dob≈ôe dopl≈àuj√≠ obecn√© talenty jako Menacing Laughter (4), Quip (4), Twin Draw (6) a Opening Volley (10)." }
                ]
            },
            {
                name: "Hellknight",
                source: "Galaxy Guide",
                description: "Jsi ƒçlenem ob√°van√©ho ≈ô√°du, kter√Ω prosazuje nekompromisn√≠ z√°kon a po≈ô√°dek inspirovan√Ω discipl√≠nou Pekla. Tv√° zbroj je symbolem tv√© autority a tv√© odhodl√°n√≠ je pevn√© jako ocel. Pro Hellknighta je z√°kon absolutn√≠ a chaos je nejvƒõt≈°√≠m nep≈ô√≠telem civilizace.",
                feats: [
                    { name: "Hellknight Dedication", level: 6, prerequisites: "ƒålenstv√≠ v ≈ô√°du Hellknight≈Ø, slo≈æen√≠ Hellknight Testu.", text: "Z√≠sk√°≈° expert√≠zu v Intimidation. Tv√° zbroj je pova≈æov√°na o kategorii lehƒç√≠ pro √∫ƒçely zdatnosti a z√≠sk√°v√° bonus k resistenci a Intimidation. Tabulka n√≠≈æe ukazuje resistence dle ≈ô√°du: <ul class='list-disc ml-4 mt-2 text-xs'><li><b>Order of the Chain:</b> electricity</li><li><b>Order of the Crucible:</b> cold</li><li><b>Order of the Eclipse:</b> void</li><li><b>Order of the Pyre:</b> fire</li></ul>" },
                    { name: "Disperse!", level: 8, prerequisites: "Hellknight Dedication", text: "Akce, kter√° ti umo≈æn√≠ odtlaƒçit nep≈ô√≠tele pomoc√≠ Intimidation a n√°sledovat ho." },
                    { name: "Infernal Bulwark", level: 10, prerequisites: "Hellknight Dedication", text: "Tv√° zbroj z√≠sk√° vlastnost 'bulwark'. Z√≠sk√°≈° resistenci (dle ≈ô√°du) rovnou polovinƒõ tv√© √∫rovnƒõ." },
                    { name: "Infernal Armaments", level: 12, prerequisites: "Hellknight Dedication", text: "Jednou za 10 minut m≈Ø≈æe≈° na minutu napustit sv√© zbranƒõ pekelnou energi√≠, kter√° p≈ôid√°v√° bonusov√© po≈°kozen√≠ (dle ≈ô√°du)." },
                    { name: "Unleash Hell!", level: 14, prerequisites: "Hellknight Dedication", text: "Jednou dennƒõ m≈Ø≈æe≈° ze sv√© zbroje vypustit 30-stop√Ω ku≈æel pekeln√© energie, kter√Ω zra≈àuje nep≈ô√°tele." }
                ]
            },
            {
                name: "Knight of Golarion",
                source: "Galaxy Guide",
                description: "Jsi ƒçlenem ryt√≠≈ôsk√©ho ≈ô√°du, kter√Ω chr√°n√≠ nevinn√©, bojuje proti tyranii a sna≈æ√≠ se zachovat kulturu ztracen√© planety Golarion. Tv√° s√≠la nepramen√≠ jen z oceli, ale i z neochvƒõjn√© v√≠ry v dobro. Ryt√≠≈ôi jsou maj√°kem nadƒõje v ƒçasto temn√© galaxii.",
                feats: [
                    { name: "Knight of Golarion Dedication", level: 2, prerequisites: "S√≠la 14.", text: "Z√≠sk√°≈° obezn√°menost se v≈°emi zbranƒõmi ze skupiny meƒç≈Ø (sword weapon group) a stane≈° se tr√©novan√Ωm ve dvou Lore dovednostech spojen√Ωch s Golarionem (nap≈ô. Golarion Lore, Iomedae Lore)." },
                    { name: "Iomedae's Shield", level: 4, prerequisites: "Knight of Golarion Dedication", text: "Akce, kterou vytvo≈ô√≠≈° sobƒõ a a≈æ pƒõti spojenc≈Øm doƒçasn√Ω energetick√Ω ≈°t√≠t s 14 ≈æivoty, kter√Ω se ka≈æd√© kolo obnovuje." },
                    { name: "Iomedae's Sword", level: 6, prerequisites: "Knight of Golarion Dedication", text: "Tv√© √∫toky proti d√©mon≈Øm, ƒè√°bl≈Øm, drak≈Øm a nemrtv√Ωm zp≈Øsobuj√≠ dodateƒçn√© p≈ôetrv√°vaj√≠c√≠ po≈°kozen√≠ duchem (spirit damage) s vlastnost√≠ 'holy'." },
                    { name: "Iomedae's Helm", level: 8, prerequisites: "Knight of Golarion Dedication", text: "Dotykem m≈Ø≈æe≈° d√°t spojenci dal≈°√≠ z√°chrann√Ω hod proti ment√°ln√≠m efekt≈Øm, jako je zmaten√≠ nebo strach." },
                    { name: "Iomedae's Barrage", level: 10, prerequisites: "Knight of Golarion Dedication", text: "Jednou dennƒõ m≈Ø≈æe≈° vytvo≈ôit nebesk√© plazmov√© dƒõlo a vyst≈ôelit ku≈æel nebo linii energie, kter√° zp≈Øsobuje po≈°kozen√≠ ohnƒõm a duchem." }
                ]
            },
            {
                name: "Xenoarcheologist",
                source: "Galaxy Guide",
                description: "Galaxie je pln√° ruin prastar√Ωch civilizac√≠ a ty jsi ten, kdo odhaluje jejich tajemstv√≠. S kloboukem na hlavƒõ a laserovou pistol√≠ po boku, jsi p≈ôipraven ƒçelit jak√©koli pasti a kletbƒõ. Znalosti jsou tv√Ωm nejvƒõt≈°√≠m pokladem.",
                feats: [
                    { name: "Xenoarcheologist Dedication", level: 2, prerequisites: "Tr√©novan√Ω v Society, Thievery a jedn√© ze znalostn√≠ch magick√Ωch dovednost√≠ (Arcana, Nature, Occultism, Religion).", text: "Stane≈° se expertem v Society a Thievery. Z√≠sk√°≈° +1 bonus na Recall Knowledge a Delve Lore p≈ôi prozkoum√°v√°n√≠. Z√≠sk√°≈° novou Lore dovednost: Delve Lore, pro znalosti o archeologick√Ωch nalezi≈°t√≠ch." },
                    { name: "Don't Touch That!", level: 2, prerequisites: "Xenoarcheologist Dedication", text: "Jako reakci m≈Ø≈æe≈° varovat spojence, kter√Ω spustil past, a potenci√°lnƒõ past zastavit nebo d√°t spojenci bonus k z√°chranƒõ." },
                    { name: "Ready for Trouble", level: 6, prerequisites: "Mistr v Thievery, Xenoarcheologist Dedication", text: "Z√≠sk√°≈° talent Danger Awareness. M≈Ø≈æe≈° pou≈æ√≠t Delve Lore k odzbrojen√≠ past√≠ z mimozemsk√Ωch nebo historicky v√Ωznamn√Ωch lokac√≠." },
                    { name: "Byzantine Linguistics", level: 7, prerequisites: "Mistr v Society, Xenoarcheologist Dedication", text: "Z√≠sk√°≈° p≈ô√≠stup k neobvykl√Ωm starovƒõk√Ωm jazyk≈Øm. M≈Ø≈æe≈° pou≈æ√≠t Society nebo Delve Lore k rozlu≈°tƒõn√≠ p√≠sma a z√≠sk√°≈° bonus k tƒõmto hod≈Øm." },
                    { name: "Statistical Anomaly", level: 10, prerequisites: "Xenoarcheologist Dedication", text: "Jednou za hodinu si m≈Ø≈æe≈° p≈ôehodit kritick√Ω ne√∫spƒõch na z√°chrann√©m hodu nebo hodu na dovednost. Pokud se jednalo o Delve Lore nebo z√°chranu proti pasti, m≈Ø≈æe≈° si nechat lep≈°√≠ v√Ωsledek." }
                ]
            },
            {
                name: "Xenodruid",
                source: "Galaxy Guide",
                description: "Nejsi jen ochr√°nce p≈ô√≠rody, jsi spojen s tepem samotn√Ωch planet. Tv√° moc poch√°z√≠ z mystick√©ho pouta s ekosyst√©my svƒõt≈Ø, co≈æ ti umo≈æ≈àuje chr√°nit je a ƒçerpat z nich s√≠lu. Jsi hlasem svƒõt≈Ø, kter√© nemohou mluvit samy za sebe.",
                feats: [
                    { name: "Xenodruid Dedication", level: 4, prerequisites: "Vlastnost mystic bond, schopnost ses√≠lat prim√°ln√≠ kouzla, tr√©novan√Ω v Nature.", text: "M≈Ø≈æe≈° vytvo≈ôit pouto s kolektivn√≠m duchem ekosyst√©mu planety. To ti d√°v√° bonusy na p≈ôe≈æit√≠ a znalosti o planetƒõ, a tak√© schopnost vyc√≠tit velk√© poruchy v jej√≠m ekosyst√©mu." },
                    { name: "Planetary Bond", level: 6, prerequisites: "Xenodruid Dedication", text: "Tv√© pouto se prohlubuje. Jsi neust√°le pod efektem kouzel speak with animals a speak with plants na tv√© sp≈ô√≠znƒõn√© planetƒõ. Z√≠sk√°≈° tak√© edikty a anat√©my spojen√© s ochranou planety." },
                    { name: "Galactic Bond", level: 12, prerequisites: "Planetary Bond", text: "M≈Ø≈æe≈° se napojit na v√≠ce planet najednou. Z√≠sk√°≈° p≈ô√≠stup ke kouzlu teleport a ritu√°lu commune, kter√© m≈Ø≈æe≈° pou≈æ√≠vat v souvislosti se sv√Ωmi planetami." },
                    { name: "Planetary Reincarnation", level: 12, prerequisites: "Xenodruid Dedication", text: "Tv√° sp≈ô√≠znƒõn√° planeta tƒõ m≈Ø≈æe o≈æivit. Z√≠sk√°≈° p≈ô√≠stup ke kouzlu breath of life, kter√© je na tv√© planetƒõ silnƒõj≈°√≠. Dokonce ho m≈Ø≈æe≈° seslat s√°m na sebe v okam≈æiku smrti." }
                ]
            }
        ],
        adventureTypes: [
            { name: "Dystopian", description: "P≈ô√≠bƒõhy boje proti √∫tlaku v korporacemi ovl√°dan√Ωch mƒõstech, na vƒõze≈àsk√Ωch planet√°ch nebo v bezpr√°vn√Ωch pustin√°ch. Hrdinov√© jsou ƒçasto mor√°lnƒõ ≈°ed√≠ anti-hrdinov√©, kte≈ô√≠ se sna≈æ√≠ p≈ôe≈æ√≠t nebo svrhnout syst√©m, kter√Ω je drt√≠."},
            { name: "High-Tech", description: "Dobrodru≈æstv√≠ zamƒõ≈ôen√° na pr≈Øzkum technologick√Ωch ruin, starobyl√Ωch artefakt≈Ø od Prvn√≠ch (First Ones) nebo ≈ôe≈°en√≠ z√°had spojen√Ωch s pokroƒçilou magitechnologi√≠. ƒåasto zahrnuj√≠ st≈ôet s umƒõlou inteligenc√≠, roboty a nepochopitelnou mimozemskou technologi√≠."},
            { name: "Fantasy", description: "P≈ô√≠bƒõhy pln√© magie, kouzeln√Ωch bytost√≠ a klasick√Ωch fantasy prvk≈Ø p≈ôenesen√Ωch do vesm√≠ru. Zahrnuje boj s draky, diplomacii s elfy nebo ≈ôe≈°en√≠ prastar√Ωch kleteb v kulis√°ch hvƒõzdn√Ωch lod√≠ a laserov√Ωch zbran√≠."},
            { name: "War-Torn", description: "Dobrodru≈æstv√≠ odehr√°vaj√≠c√≠ se na pozad√≠ velk√Ωch galaktick√Ωch konflikt≈Ø, jako je v√°lka mezi Veskariem a Azlantskou hvƒõzdnou ≈ô√≠≈°√≠. M≈Ø≈æe j√≠t o ≈°pion√°≈æ, frontov√Ω boj, z√°chranu uprchl√≠k≈Ø nebo profitov√°n√≠ z chaosu."},
            { name: "Into the Unknown", description: "Explorace neprob√°dan√Ωch ƒç√°st√≠ galaxie, objevov√°n√≠ nov√Ωch svƒõt≈Ø, prvn√≠ch kontakt≈Ø s nezn√°m√Ωmi rasami a ≈ôe≈°en√≠ kosmick√Ωch anom√°li√≠. Tyto p≈ô√≠bƒõhy se zamƒõ≈ôuj√≠ na √∫≈æas a nebezpeƒç√≠ objevov√°n√≠."},
            { name: "Horror", description: "P≈ô√≠bƒõhy pln√© napƒõt√≠, strachu a boje o p≈ôe≈æit√≠ proti nemrtv√Ωm, kosmick√Ωm hr≈Øz√°m nebo s√©riov√Ωm vrah≈Øm v temn√Ωch z√°kout√≠ch vesm√≠ru. D≈Øraz je kladen na atmosf√©ru a psychologick√Ω tlak."},
            { name: "Weird", description: "Bizarn√≠ a surre√°ln√° dobrodru≈æstv√≠, kter√° pop√≠raj√≠ ≈æ√°nrov√© konvence. M≈Ø≈æe j√≠t o cestov√°n√≠ dimenzemi, setk√°n√≠ s paradoxn√≠mi entitami, ≈ôe≈°en√≠ nelogick√Ωch z√°had nebo hran√≠ za rockovou kapelu ve vesm√≠ru."}
        ],
        locations: [
            { name: "Absalom Station", description: "Centrum Paktov√Ωch svƒõt≈Ø, obrovsk√° kosmopolitn√≠ stanice.", faction: "Paktov√© svƒõty (r≈Øzn√© frakce)", dayLength: "24 hodin (umƒõle)", gravity: "Norm√°ln√≠ (umƒõl√°)" },
            { name: "Akiton", description: "Um√≠raj√≠c√≠ rud√° planeta pln√° vrakovi≈°≈• a bezpr√°v√≠.", faction: "Nez√°visl√© (gangy, korporace)", dayLength: "24 hodin", gravity: "N√≠zk√°" },
            { name: "Verces", description: "Technologicky vyspƒõl√Ω svƒõt s jednou stranou sp√°lenou a druhou zmrzlou.", faction: "Prsten n√°rod≈Ø", dayLength: "V√°zan√° rotace (vƒõƒçn√Ω soumrak)", gravity: "Norm√°ln√≠" },
            { name: "The Idari", description: "Masivn√≠ generaƒçn√≠ loƒè Kasath≈Ø.", faction: "Kasathov√© (Doyenate)", dayLength: "27 hodin (umƒõle)", gravity: "Vysok√° (umƒõl√°)" },
            { name: "Eox", description: "Radioaktivn√≠ planeta nemrtv√Ωch, ovl√°dan√° mocn√Ωmi nekromanty.", faction: "Vƒõƒçn√© shrom√°≈ædƒõn√≠ (Eternal Convocation)", dayLength: "30 dn√≠", gravity: "Norm√°ln√≠" },
            { name: "Castrovel", description: "Divok√Ω svƒõt d≈æungl√≠, kde soupe≈ô√≠ elfov√©, la≈°untov√© a formian√©.", faction: "Lashunta-Formian Federation", dayLength: "24 hodin", gravity: "Norm√°ln√≠" },
            { name: "Triaxus", description: "Planeta extr√©m≈Ø, domov drak≈Ø a legend√°rn√≠ Skyfire Legion.", faction: "Spojen√° √∫zem√≠ (ryphoriani, drakoni)", dayLength: "24 hodin", gravity: "Norm√°ln√≠" },
            { name: "The Diaspora", description: "P√°s asteroid≈Ø pln√Ω pir√°t≈Ø, tƒõ≈æa≈ô≈Ø a domorod√Ωch Sarcesian≈Ø.", faction: "Svobodn√≠ kapit√°ni, Sarcesian√©", dayLength: "Promƒõnliv√°", gravity: "Promƒõnliv√° / Nulov√°" }
        ],
        factions: [
            { name: "Starfinder Society", description: "Organizace dobrodruh≈Ø a uƒçenc≈Ø, kte≈ô√≠ prozkoum√°vaj√≠ galaxii, odhaluj√≠ jej√≠ tajemstv√≠ a pod√°vaj√≠ o nich zpr√°vy. Jejich heslem je 'Prozkoumat, Zaznamenat, Spolupracovat'. Jsou to klasiƒçt√≠ dobrodruzi, kte≈ô√≠ se pletou do v≈°eho." },
            { name: "Stewards", description: "M√≠rov√© s√≠ly Paktov√Ωch svƒõt≈Ø, kter√© udr≈æuj√≠ po≈ô√°dek a chr√°n√≠ ƒçlensk√© planety. Funguj√≠ jako galaktick√° policie a arm√°da v jednom. Jsou symbolem z√°kona, ale nƒõkdy jsou vn√≠m√°ni jako p≈ô√≠li≈° byrokratiƒçt√≠." },
            { name: "Hellknights", description: "Nel√≠tostn√Ω ≈ô√°d v√°leƒçn√≠k≈Ø, kte≈ô√≠ prosazuj√≠ z√°kon a po≈ô√°dek pomoc√≠ strachu a s√≠ly, inspirovan√≠ strukturou Pekla. Jsou to extremist√©, pro kter√© je ≈ô√°d nade v≈°e, i nad mor√°lku." },
            { name: "Free Captains", description: "Voln√° aliance pir√°tsk√Ωch pos√°dek, kter√° operuje p≈ôedev≈°√≠m z asteroidov√©ho p√°su Diaspora. Nemaj√≠ ≈æ√°dn√©ho v≈Ødce, ale ≈ô√≠d√≠ se kodexem, kter√Ω jim umo≈æ≈àuje koexistovat. Jsou symbolem svobody a anarchie." },
            { name: "AbadarCorp", description: "Megakorporace a c√≠rkev boha civilizace Abadara v jednom. Ovl√°daj√≠ bankovnictv√≠ a obchod v Paktov√Ωch svƒõtech. Pro nƒõkoho jsou nositeli pokroku, pro jin√© bezcitn√Ωmi kapitalisty." },
            { name: "Xenowardens", description: "Ochr√°nci p≈ô√≠rody, kte≈ô√≠ se sna≈æ√≠ chr√°nit ekosyst√©my galaxie p≈ôed zniƒçen√≠m a vyko≈ôis≈•ov√°n√≠m. ƒåasto se dost√°vaj√≠ do konfliktu s korporacemi a pr≈Ømyslov√Ωmi z√°jmy. Jsou to vesm√≠rn√≠ druidov√© a ekoterorist√©." },
            { name: "Corpse Fleet", description: "Frakce odpadl√≠k≈Ø z Eoxu, kte≈ô√≠ odm√≠tli m√≠r s Paktov√Ωmi svƒõty a nyn√≠ usiluj√≠ o nadvl√°du nemrtv√Ωch. Jsou to hlavn√≠ antagonist√©, kte≈ô√≠ chtƒõj√≠ vidƒõt galaxii v podruƒç√≠ smrti." },
            { name: "Veskarium", description: "Mocn√° a militaristick√° ≈ô√≠≈°e reptili√°nsk√Ωch Vesk≈Ø a jejich podroben√Ωch svƒõt≈Ø v syst√©mu Ghavaniska. Cen√≠ si s√≠ly, cti a dob√Ωv√°n√≠ nade v≈°e. Po dlouh√© Tich√© v√°lce jsou v nestabiln√≠m spojenectv√≠ s Paktov√Ωmi svƒõty, ale jejich hlavn√≠m rivalem je nyn√≠ Azlantsk√° hvƒõzdn√° ≈ô√≠≈°e." },
            { name: "Azlanti Star Empire", description: "Expanzivn√≠, xenofobn√≠ lidsk√° ≈ô√≠≈°e ve Vastu, kter√° vƒõ≈ô√≠ ve svou nad≈ôazenost a sna≈æ√≠ se dob√Ωt nebo zniƒçit v≈°echny ostatn√≠ rasy. Jsou to klasiƒçt√≠ 'zl√≠ imp√©ria' vesm√≠rn√Ωch oper." }
        ],
        ancestries: [
            { name: "Android", description: "Umƒõle vytvo≈ôen√© bytosti s du≈°√≠, ƒçasto hledaj√≠c√≠ sv√© m√≠sto a identitu ve svƒõtƒõ.", hp: 8, size: "St≈ôedn√≠", speed: "25 stop", boosts: "Obratnost, Inteligence, Voliteln√Ω", flaw: "Charisma", abilities: [ { name: "Low-Light Vision", text: "Vid√≠≈° v ≈°eru jako za svƒõtla." }, { name: "Constructed Body", text: "Jsi imunn√≠ v≈Øƒçi nemocem, ale efekty, kter√© l√©ƒç√≠ ≈æiv√©, na tebe maj√≠ men≈°√≠ √∫ƒçinek." } ] },
            { name: "Human", description: "Nejroz≈°√≠≈ôenƒõj≈°√≠ a nejp≈ôizp≈Øsobivƒõj≈°√≠ rasa, zn√°m√° svou ambic√≠ a odolnost√≠.", hp: 8, size: "St≈ôedn√≠", speed: "25 stop", boosts: "Dva voliteln√©", flaw: "≈Ω√°dn√Ω", abilities: [ { name: "Versatile Heritage", text: "Na 1. √∫rovni z√≠sk√°≈° obecn√Ω talent (General Feat)." } ] },
            { name: "Kasatha", description: "ƒåty≈ôruc√≠ humanoidi s p≈ô√≠snou tradic√≠, poch√°zej√≠c√≠ z generaƒçn√≠ lodi Idari.", hp: 8, size: "St≈ôedn√≠", speed: "30 stop", boosts: "S√≠la, Moudrost, Voliteln√Ω", flaw: "Inteligence", abilities: [ { name: "Four-Armed", text: "M√°≈° ƒçty≈ôi pa≈æe, co≈æ ti umo≈æ≈àuje dr≈æet v√≠ce p≈ôedmƒõt≈Ø." }, { name: "Desert Stride", text: "Pohyb v pou≈°tn√≠m ter√©nu tƒõ nezpomaluje." } ] },
            { name: "Lashunta", description: "Telepatiƒçt√≠ humanoid√© se dvƒõma poddruhy: vysok√Ωmi a intelektu√°ln√≠mi damaya a men≈°√≠mi, silnƒõj≈°√≠mi korasha.", hp: 6, size: "St≈ôedn√≠", speed: "30 stop", boosts: "Inteligence, Charisma, Voliteln√Ω", flaw: "Odolnost", abilities: [ { name: "Limited Telepathy", text: "M≈Ø≈æe≈° ment√°lnƒõ komunikovat s bytostmi v dosahu 30 stop." }, { name: "Lashunta Magic", text: "Z√≠sk√°≈° psychick√° kouzla jako cantripy (Daze, Telekinetic Projectile)." } ] },
            { name: "Shirren", description: "Hmyz√≠ humanoidi, kte≈ô√≠ se osvobodili od kolektivn√≠ mysli Roje (Swarm) a cen√≠ si individuality.", hp: 8, size: "St≈ôedn√≠", speed: "25 stop", boosts: "Odolnost, Moudrost, Voliteln√Ω", flaw: "Charisma", abilities: [ { name: "Communalism", text: "Z√≠sk√°≈° bonus +2 k hod≈Øm na pomoc (Aid)." }, { name: "Limited Telepathy", text: "M≈Ø≈æe≈° ment√°lnƒõ komunikovat s bytostmi v dosahu 30 stop." } ] },
            { name: "Vesk", description: "V√°leƒçn√≠ reptili√°ni, jejich≈æ ≈ô√≠≈°e Veskarium je hlavn√≠m rivalem Paktov√Ωch svƒõt≈Ø.", hp: 10, size: "St≈ôedn√≠", speed: "30 stop", boosts: "S√≠la, Odolnost, Voliteln√Ω", flaw: "Inteligence", abilities: [ { name: "Natural Weapons", text: "M√°≈° neozbrojen√Ω √∫tok dr√°py (1d3 S)." }, { name: "Armor Savant", text: "P≈ôi no≈°en√≠ tƒõ≈æk√© zbroje se ti zvy≈°uje maxim√°ln√≠ bonus k Obratnosti o 1." } ] },
            { name: "Ysoki", description: "D≈ô√≠ve zn√°m√≠ jako krys√°ci (ratfolk), jsou to chyt≈ô√≠ a spoleƒçen≈°t√≠ humanoidi, kte≈ô√≠ exceluj√≠ v p≈ôeplnƒõn√Ωch mƒõstech a na lod√≠ch.", hp: 6, size: "Mal√°", speed: "25 stop", boosts: "Obratnost, Inteligence, Voliteln√Ω", flaw: "S√≠la", abilities: [ { name: "Cheek Pouches", text: "M≈Ø≈æe≈° uskladnit a≈æ 1 krychlovou stopu p≈ôedmƒõt≈Ø ve sv√Ωch l√≠cn√≠ch torb√°ch." }, { name: "Darkvision", text: "Vid√≠≈° perfektnƒõ ve tmƒõ (ƒçernob√≠le)." } ] },
            { name: "Astrazoan", description: "Tvaromƒõniƒçi s bizarn√≠ pravou podobou, schopn√≠ dokonale napodobit jin√© rasy.", hp: 8, size: "St≈ôedn√≠", speed: "25 stop", boosts: "Obratnost, Charisma, Voliteln√Ω", flaw: "Odolnost", abilities: [ { name: "Low-Light Vision", text: "Vid√≠≈° v ≈°eru jako za svƒõtla." }, { name: "Change Shape", text: "Jako jednu akci se m≈Ø≈æe≈° p≈ôemƒõnit do podoby jak√©koliv Small, Medium nebo Large rasy." } ] },
            { name: "Contemplative", description: "Telepatiƒçt√≠ megamozky s atrofovan√Ωmi tƒõly, mist≈ôi psychick√Ωch sil.", hp: 6, size: "St≈ôedn√≠", speed: "5 stop (vzn√°≈°en√≠); let 20 stop", boosts: "Inteligence, Charisma, Voliteln√Ω", flaw: "S√≠la", abilities: [ { name: "Atrophied", text: "Tv√© konƒçetiny jsou zakrnƒõl√©, co≈æ sni≈æuje tvou nosnost." }, { name: "Thoughtsense", text: "Vn√≠m√°≈° mysl√≠c√≠ bytosti v okol√≠ 20 stop." }, { name: "Limited Telepathy", text: "M≈Ø≈æe≈° ment√°lnƒõ komunikovat s bytostmi v dosahu 30 stop." } ] },
            { name: "Dragonkin", description: "Humanoidn√≠ draci, kte≈ô√≠ mohou vytvo≈ôit hlubok√© telepatick√© pouto s jedn√≠m partnerem.", hp: 10, size: "Velk√Ω (Large)", speed: "20 stop, L√©t√°n√≠ 20 stop", boosts: "Dva voliteln√©", flaw: "≈Ω√°dn√Ω", abilities: [ { name: "Darkvision", text: "Vid√≠≈° perfektnƒõ ve tmƒõ (ƒçernob√≠le)." }, { name: "Partner Bond", text: "M≈Ø≈æe≈° vytvo≈ôit permanentn√≠ empatick√© pouto s jednou ochotnou bytost√≠." } ] },
            { name: "Kalo", description: "Vodn√≠ humanoidi zn√°m√≠ svou elegantn√≠ m√≥dou a bojov√Ωm umƒõn√≠m.", hp: 6, size: "St≈ôedn√≠", speed: "20 stop, Plav√°n√≠ 30 stop", boosts: "Obratnost, Charisma, Voliteln√Ω", flaw: "Odolnost", abilities: [ { name: "Darkvision", text: "Vid√≠≈° perfektnƒõ ve tmƒõ (ƒçernob√≠le)." }, { name: "Hydration", text: "Mus√≠≈° se pravidelnƒõ no≈ôit do vody, jinak tv√° k≈Ø≈æe zaƒçne praskat." } ] },
            { name: "Sarcesian", description: "Vesm√≠rn√≠ poutn√≠ci s energetick√Ωmi k≈ô√≠dly, schopn√≠ p≈ôe≈æ√≠t ve vakuu.", hp: 8, size: "Velk√Ω (Large)", speed: "25 stop", boosts: "Obratnost, Charisma, Voliteln√Ω", flaw: "S√≠la", abilities: [ { name: "Energy Wings", text: "Ve vakuu m≈Ø≈æe≈° manifestovat energetick√° k≈ô√≠dla a l√©tat." }, { name: "Suspended Respiration", text: "Dok√°≈æe≈° doƒçasnƒõ p≈ôe≈æ√≠t ve vakuu bez d√Ωch√°n√≠." } ] },
            { name: "Vlaka", description: "Vlƒç√≠ nom√°di s bystr√Ωmi smysly a siln√Ωm smyslem pro komunitu.", hp: 6, size: "St≈ôedn√≠", speed: "25 stop", boosts: "Moudrost, Charisma, Voliteln√Ω", flaw: "Obratnost", abilities: [ { name: "Sensory Diversity", text: "M√°≈° vynikaj√≠c√≠ ƒçich a m≈Ø≈æe≈° se narodit slep√Ω, hluch√Ω nebo oboj√≠, co≈æ ti d√°v√° jin√© v√Ωhody." }, { name: "Versed", text: "Jsi zbƒõhl√Ω ve znakov√© ≈ôeƒçi." } ] },
            { name: "Pahtra", description: "Hbit√≠, koƒçkovit√≠ humanoid√© z planety Pulonis, zn√°m√≠ svou nez√°vislost√≠ a rebelsk√Ωm duchem.", hp: 8, size: "St≈ôedn√≠", speed: "30 stop", boosts: "Obratnost, Charisma, Voliteln√Ω", flaw: "Moudrost", abilities: [ { name: "Low-Light Vision", text: "Vid√≠≈° v ≈°eru jako za svƒõtla." }, { name: "Cat's Luck", text: "Jednou dennƒõ si m≈Ø≈æe≈° p≈ôehodit ne√∫spƒõ≈°n√Ω z√°chrann√Ω hod na Reflexy." } ] },
            { name: "Ijtikri", description: "Z√°hadn√≠, chobotnic√≠m podobn√≠ humanoid√© z vodn√≠ho svƒõta Vesk-2. Komunikuj√≠ pomoc√≠ bioluminiscence.", hp: 6, size: "St≈ôedn√≠", speed: "20 stop, Plav√°n√≠ 30 stop", boosts: "Inteligence, Moudrost, Voliteln√Ω", flaw: "S√≠la", abilities: [ { name: "Darkvision", text: "Vid√≠≈° perfektnƒõ ve tmƒõ (ƒçernob√≠le)." }, { name: "Amphibious", text: "M≈Ø≈æe≈° d√Ωchat na vzduchu i ve vodƒõ." }, { name: "Ink Cloud", text: "Jako reakci na zranƒõn√≠ m≈Ø≈æe≈° vypustit oblak inkoustu, kter√Ω tƒõ skryje." } ] }
        ],
        classes: [
            { name: "Envoy", description: "Charismatick√Ω diplomat a taktik, kter√Ω inspiruje sv√© spojence a mate nep≈ô√°tele.", keyAbility: "Charisma", role: "Podpora, Kontrolor, Tv√°≈ô skupiny", armor: "Lehk√° zbroj", weapons: "Jednoduch√© a mal√© zbranƒõ na bl√≠zko, gran√°ty." },
            { name: "Mechanic", description: "Mistr technologie, kter√Ω bojuje po boku sv√©ho dron√≠ho spoleƒçn√≠ka nebo s experiment√°ln√≠mi zbranƒõmi.", keyAbility: "Inteligence", role: "Po≈°kozovatel, Kontrolor, U≈æiteƒçnost", armor: "Lehk√° a tƒõ≈æk√° zbroj", weapons: "Jednoduch√© a pokroƒçil√© zbranƒõ na bl√≠zko, gran√°ty." },
            { name: "Mystic", description: "U≈æivatel magie, kter√Ω ƒçerp√° s√≠lu z propojen√≠ s fundament√°ln√≠mi silami vesm√≠ru.", keyAbility: "Moudrost", role: "L√©ƒçitel, Podpora, Sesilatel kouzel", armor: "Lehk√° zbroj", weapons: "Jednoduch√© a mal√© zbranƒõ na bl√≠zko." },
             { name: "Operative", description: "Zruƒçn√Ω expert na infiltraci, ≈°pion√°≈æ a p≈ôesn√©, smrt√≠c√≠ √∫toky.", keyAbility: "Obratnost", role: "Po≈°kozovatel (Skillful), Pr≈Øzkumn√≠k", armor: "Lehk√° zbroj", weapons: "Jednoduch√© a mal√© zbranƒõ na bl√≠zko, odst≈ôelovac√≠ pu≈°ky." },
            { name: "Solarian", description: "Kosmick√Ω v√°leƒçn√≠k, kter√Ω manipuluje s energiemi hvƒõzd a ƒçern√Ωch dƒõr.", keyAbility: "Charisma", role: "Po≈°kozovatel na bl√≠zko, Tank", armor: "Lehk√° a tƒõ≈æk√° zbroj", weapons: "Jednoduch√© a pokroƒçil√© zbranƒõ na bl√≠zko, mal√© zbranƒõ." },
            { name: "Soldier", description: "Mistr v≈°ech druh≈Ø boje, specializuj√≠c√≠ se na r≈Øzn√© bojov√© styly a zbranƒõ.", keyAbility: "S√≠la nebo Obratnost", role: "Po≈°kozovatel, Tank", armor: "Lehk√° a tƒõ≈æk√° zbroj, ≈°t√≠ty", weapons: "V≈°echny jednoduch√© a v√°leƒçn√© zbranƒõ, tƒõ≈æk√© zbranƒõ, gran√°ty." },
            { name: "Technomancer", description: "Kouzeln√≠k, kter√Ω prol√≠n√° technologii s magi√≠, schopn√Ω 'hackovat' samotnou realitu.", keyAbility: "Inteligence", role: "Sesilatel kouzel, Kontrolor, U≈æiteƒçnost", armor: "Lehk√° zbroj", weapons: "Jednoduch√© a mal√© zbranƒõ na bl√≠zko." },
        ],
    };

    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const apiKeyInput = document.getElementById('api-key-input');
        const saveApiKeyBtn = document.getElementById('save-api-key-btn');
        const apiKeyStatus = document.getElementById('api-key-status');
        let userApiKey = localStorage.getItem('starfinderApiKey') || '';
        
        // Generator history storage
        let histories = {
            adventure: [],
            npc: [],
            ship: [],
        };
        let currentIndices = {
            adventure: -1,
            npc: -1,
            ship: -1,
        };

        const isCanvasEnv = (window.self !== window.top);
        if (isCanvasEnv) {
            document.getElementById('api-key-section').style.display = 'none';
            userApiKey = "";
        } else {
            document.getElementById('api-key-section').style.display = 'block'; // Ensure it's visible outside canvas
            apiKeyInput.value = userApiKey;
            if(userApiKey) apiKeyStatus.textContent = 'API kl√≠ƒç je ulo≈æen.';
        }

        saveApiKeyBtn.addEventListener('click', () => {
            userApiKey = apiKeyInput.value.trim();
            localStorage.setItem('starfinderApiKey', userApiKey);
            apiKeyStatus.textContent = 'API kl√≠ƒç ulo≈æen!';
            setTimeout(() => apiKeyStatus.textContent = (userApiKey ? 'API kl√≠ƒç je ulo≈æen.' : ''), 3000);
        });

        function switchTab(targetTabId) {
            tabContents.forEach(content => content.classList.remove('active'));
            tabs.forEach(tab => tab.classList.remove('active'));
            document.getElementById(targetTabId).classList.add('active');
            document.querySelector(`[data-tab="${targetTabId}"]`).classList.add('active');
        }

        tabs.forEach(tab => {
            tab.addEventListener('click', () => switchTab(tab.dataset.tab));
        });

        function setupExpandableCards(containerSelector) {
            const container = document.querySelector(containerSelector);
            if (!container) return;
            container.addEventListener('click', e => {
                const header = e.target.closest('.card-header');
                if (header) {
                    const content = header.nextElementSibling;
                    header.classList.toggle('open');
                    content.classList.toggle('open');
                }
            });
        }
        
        function getTabTitle(tabId) {
            const titles = {
                'adventures-tab': "Typy Dobrodru≈æstv√≠", 'locations-tab': "Kl√≠ƒçov√© Lokace",
                'factions-tab': "Frakce a Imp√©ria", 'ancestries-tab': "Hrateln√© Rasy",
                'classes-tab': "Povol√°n√≠", 'archetypes-tab': "Archetypy Galaxie"
            };
            return titles[tabId] || "";
        }
        
        function renderCard(item, detailsHtml) {
             const card = document.createElement('div');
                card.className = `card p-5 rounded-lg flex flex-col`;
                
                card.innerHTML = `
                    <div class="card-header flex justify-between items-start cursor-pointer">
                        <div class="flex-1 pr-4">
                            <h4 class="text-xl font-bold text-f5c2e7">${item.name}</h4>
                            <p class="text-xs text-gray-400 mt-1">${item.description.substring(0, 100)}${item.description.length > 100 ? '...' : ''}</p>
                        </div>
                        <button class="expand-btn text-2xl font-bold ml-4">+</button>
                    </div>
                    <div class="card-expand text-sm mt-4 border-t border-blue-500/20 pt-4">
                        ${detailsHtml}
                    </div>`;
                return card;
        }

        function renderSimpleCards(data, containerId, cardClass) {
            const container = document.getElementById(containerId);
            container.innerHTML = `<h2 class="text-3xl font-bold mb-8 text-center">${getTabTitle(containerId)}</h2>
                                   <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 ${cardClass}-container"></div>`;
            const grid = container.querySelector(`.${cardClass}-container`);
            data.forEach(item => {
                let detailsHtml = `<p>${item.description}</p>`;
                if (cardClass === 'location') {
                    detailsHtml += `
                        <div class="mt-3 pt-3 border-t border-blue-500/20 text-xs space-y-1">
                            <p><strong>Frakce:</strong> ${item.faction || 'N/A'}</p>
                            <p><strong>D√©lka dne:</strong> ${item.dayLength || 'N/A'}</p>
                            <p><strong>Gravitace:</strong> ${item.gravity || 'N/A'}</p>
                        </div>
                    `;
                }
                grid.appendChild(renderCard(item, detailsHtml));
            });
            setupExpandableCards(`#${containerId}`);
        }

        function renderDetailedCards(data, containerId, cardClass, detailRenderer) {
            const container = document.getElementById(containerId);
            container.innerHTML = `<h2 class="text-3xl font-bold mb-8 text-center">${getTabTitle(containerId)}</h2>
                                   <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 ${cardClass}-container"></div>`;
            const grid = container.querySelector(`.${cardClass}-container`);
            data.forEach(item => {
                grid.appendChild(renderCard(item, detailRenderer(item)));
            });
            setupExpandableCards(`#${containerId}`);
        }

        function renderRaceDetails(item) {
            const abilitiesHtml = item.abilities.map(ab => `
                <div class="feat !border-l-fuchsia-400">
                    <p class="font-bold text-base text-fuchsia-400">${ab.name}</p>
                    <p class="text-sm">${ab.text}</p>
                </div>
            `).join('');
            return `
                <p class="mb-4">${item.description}</p>
                <h5 class="font-bold text-lg mb-2 text-fuchsia-400">Z√°kladn√≠ Vlastnosti</h5>
                <ul class="list-disc ml-5 text-xs grid grid-cols-2 gap-x-4">
                    <li><b>HP:</b> ${item.hp}</li>
                    <li><b>Velikost:</b> ${item.size}</li>
                    <li><b>Rychlost:</b> ${item.speed}</li>
                    <li><b>Vylep≈°en√≠:</b> ${item.boosts}</li>
                    <li><b>Oslaben√≠:</b> ${item.flaw}</li>
                </ul>
                <h5 class="font-bold text-lg mt-4 mb-2 text-fuchsia-400">Schopnosti Rasy</h5>
                ${abilitiesHtml}
            `;
        }

        function renderClassDetails(item) {
            return `
                <p class="mb-4">${item.description}</p>
                <h5 class="font-bold text-lg mb-2 text-fuchsia-400">Charakteristiky</h5>
                <ul class="list-disc ml-5 text-sm space-y-1">
                    <li><b>Kl√≠ƒçov√° vlastnost:</b> ${item.keyAbility}</li>
                    <li><b>Role v dru≈æinƒõ:</b> ${item.role}</li>
                </ul>
                <h5 class="font-bold text-lg mt-4 mb-2 text-fuchsia-400">Zdatnosti</h5>
                 <ul class="list-disc ml-5 text-sm space-y-1">
                    <li><b>Zbroje:</b> ${item.armor}</li>
                    <li><b>Zbranƒõ:</b> ${item.weapons}</li>
                </ul>
            `;
        }
        
        function renderArchetypeCards() {
            const container = document.getElementById('archetypes-tab');
            container.innerHTML = `<h2 class="text-3xl font-bold mb-8 text-center">Archetypy Galaxie</h2>
                                   <p class="text-center max-w-3xl mx-auto mb-8 text-gray-400">Archetypy umo≈æ≈àuj√≠ postav√°m z√≠skat talenty z jin√Ωch povol√°n√≠ nebo se specializovat na unik√°tn√≠ koncepty. Postava si m≈Ø≈æe vz√≠t talent archetypu m√≠sto talentu sv√©ho povol√°n√≠ (class feat).</p>
                                   <div class="grid grid-cols-1 md:grid-cols-2 gap-8 archetype-container"></div>`;
            const grid = container.querySelector('.archetype-container');
            starfinderData.archetypes.forEach(archetype => {
                let featsHtml = archetype.feats.map(feat => `
                    <div class="feat">
                        <p class="font-bold text-base text-f5c2e7">Talent ${feat.level}: ${feat.name}</p>
                        ${feat.prerequisites ? `<p class="text-xs text-gray-400 italic mb-1">Po≈æadavky: ${feat.prerequisites}</p>` : ''}
                        <p class="text-sm">${feat.text}</p>
                    </div>
                `).join('');

                const detailsHtml = `
                    <p class="mb-4">${archetype.description}</p>
                    <h5 class="text-lg font-bold mb-2">Talenty Archetypu</h5>
                    ${featsHtml}
                `;
                 grid.appendChild(renderCard(archetype, detailsHtml));
            });
            setupExpandableCards('#archetypes-tab');
        }

        function markdownToHtml(text) {
             return text
                 .replace(/^### (.*$)/gim, '<h4 class="font-bold text-f5c2e7 mt-3 mb-1">$1</h4>')
                 .replace(/^## (.*$)/gim, '<h3 class="font-bold text-xl mt-4 mb-2">$1</h3>')
                 .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                 .replace(/\*(.*?)\*/g, '<em>$1</em>')
                 .replace(/^- (.*$)/gim, '<li class="ml-4 list-disc">$1</li>')
                 .replace(/\n/g, '<br>');
        }
        
        function downloadText(filename, text) {
            if (!text || text.trim() === '') {
                return; // Do nothing if there's no text
            }
            const element = document.createElement('a');
            const file = new Blob([text.replace(/<br\s*[\/]?>/gi, "\n").replace(/<[^>]*>/g, '')], {type: 'text/plain;charset=utf-8'});
            element.href = URL.createObjectURL(file);
            element.download = filename;
            document.body.appendChild(element); // Required for Firefox
            element.click();
            document.body.removeChild(element);
        }
        
        function sanitizeForFilename(text) {
            if (!text) return 'neznamy';
            return text.replace(/[^a-z0-9]/gi, '_').toLowerCase().substring(0, 25);
        }

        function getFormattedDate() {
            const d = new Date();
            const year = d.getFullYear();
            const month = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        function extractName(htmlContent, type, contextInputElement) {
             if (!htmlContent) return "neznamy";
             
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;

             if (type === 'npc') {
                const headings = Array.from(tempDiv.querySelectorAll('h4'));
                const nameHeading = headings.find(h => h.textContent.includes('Jm√©no a koncept'));
                 if (nameHeading) {
                     let sibling = nameHeading.nextSibling;
                     while(sibling && sibling.nodeType === 3 && !sibling.textContent.trim()){
                         sibling = sibling.nextSibling;
                     }
                      if(sibling && sibling.nodeType === 1) sibling = sibling.firstChild; // Look inside the <p> tag
                      if(sibling && sibling.textContent.trim()) {
                        return sibling.textContent.trim().split(/<br>|\n/)[0];
                     }
                 }
             } else if (type === 'ship') {
                 const bold = tempDiv.querySelector('strong');
                 if (bold) return bold.textContent.trim();
             }
             return contextInputElement ? (contextInputElement.value.trim() || `gen_${type}`) : `gen_${type}`;
        }


         async function callGeminiAPI(originalPrompt, userContext, outputDiv, button, historyType) {
            if (!isCanvasEnv && !userApiKey) {
                outputDiv.innerHTML = '<p class="text-red-400">Chyba: Nebyl zad√°n Gemini API kl√≠ƒç. Pros√≠m, zadejte platn√Ω kl√≠ƒç v patiƒçce str√°nky.</p>';
                return;
            }
            button.disabled = true;
            outputDiv.innerHTML = '<div class="flex justify-center items-center h-full"><div class="spinner"></div></div>';
            
            const loreContext = `Kontext pro Starfinder 2e:
Toto je science-fantasy vesm√≠r. Kl√≠ƒçov√© lokace zahrnuj√≠ Syst√©m Paktov√Ωch svƒõt≈Ø (Absalom Station, Akiton, Castrovel, Verces), Veskarium (≈ô√≠≈°e reptili√°nsk√Ωch Vesk≈Ø) a Azlantsk√© hvƒõzdn√© imp√©rium (xenofobn√≠ lidsk√° ≈ô√≠≈°e). Cestov√°n√≠ nadsvƒõtelnou rychlost√≠ se dƒõje skrze dimenzi zvanou Drift. Ned√°vn√© ud√°losti, jako Driftov√° krize a zrozen√≠ nov√©ho boha zvan√©ho Novorozenƒõ, ot≈ô√°sly galaxi√≠. Prob√≠h√° v√°lka mezi Veskariem a Azlantsk√Ωm imp√©riem.
Kl√≠ƒçov√© frakce: Starfinder Society, Stewardi, Pekeln√≠ ryt√≠≈ôi, Svobodn√≠ kapit√°ni, Xenostr√°≈æci, Mrtvoln√° flotila, AbadarCorp.
Kl√≠ƒçov√© rasy: Lid√©, Androidi, Kasathov√©, Lashuntov√©, Shirreni, Vesk, Ysoki, Astrazoan√©, Kontemplativci, Drakoni, Kalo, Sarcesi√°ni, Vlaka.
Kl√≠ƒçov√° povol√°n√≠: Posel, Mystik, Agent, Solarian, Voj√°k, ƒåarodƒõj reality.
T√≥n: Dobrodru≈æstv√≠ mohou b√Ωt dystopick√°, high-tech, fantasy, v√°leƒçn√°, hororov√°, pr≈Øzkumnick√° nebo bizarn√≠. Technologie jako kybernetika, biotechnologie a magitechnologie jsou bƒõ≈æn√©.
`;
            
            const finalPrompt = `${loreContext}\n\nNa z√°kladƒõ v√Ω≈°e uveden√©ho kontextu spl≈àte n√°sleduj√≠c√≠ po≈æadavek v ƒçe≈°tinƒõ:\n\n${originalPrompt}`;

            const apiKey = userApiKey;
            const model = 'gemini-2.0-flash';
            const endpoint = 'generateContent';
            const chatHistory = [{ role: "user", parts: [{ text: finalPrompt }] }];
            const payload = { contents: chatHistory };
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:${endpoint}?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    let errorMsg = `Chyba API (HTTP ${response.status}). Zkontrolujte kl√≠ƒç a opr√°vnƒõn√≠.`;
                    try {
                        const errorResult = await response.json();
                        if (errorResult.error && errorResult.error.message) {
                            errorMsg += ` Detail: ${errorResult.error.message}`;
                        }
                    } catch (e) {
                         const textError = await response.text();
                         console.error("Non-JSON error response from API:", textError);
                         errorMsg += ' Odpovƒõƒè serveru nebyla platn√Ω JSON.';
                    }
                    outputDiv.innerHTML = `<p class="text-red-400">${errorMsg}</p>`;
                    return;
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content) {
                    let promptDisplay = '';
                    if (userContext && userContext.trim() !== '') {
                        promptDisplay = `<p class="text-xs text-gray-500 italic border-b border-gray-600 pb-2 mb-2"><strong>Pou≈æit√Ω n√°mƒõt:</strong> ${userContext}</p>`;
                    }
                    const generatedText = markdownToHtml(result.candidates[0].content.parts[0].text);
                    const fullHtml = promptDisplay + generatedText;
                    outputDiv.innerHTML = fullHtml;
                    
                    if(historyType){
                        histories[historyType].push({html: fullHtml, context: userContext});
                        currentIndices[historyType] = histories[historyType].length - 1;
                        updateHistoryUI(historyType);
                    }
                } else {
                    let errorMsg = 'Chyba p≈ôi generov√°n√≠. Odpovƒõƒè API byla nekompletn√≠.';
                    if (result.promptFeedback && result.promptFeedback.blockReason) {
                        errorMsg = `Obsah byl zablokov√°n z d≈Øvodu: ${result.promptFeedback.blockReason}`;
                    } else if (result.error) {
                        errorMsg = `Chyba API: ${result.error.message}`;
                    }
                    console.error("Incomplete or blocked response from API:", result);
                    outputDiv.innerHTML = `<p class="text-red-400">${errorMsg}</p>`;
                }
            } catch (error) {
                console.error("API Call/Parsing Error:", error);
                outputDiv.innerHTML = '<p class="text-red-400">Do≈°lo k chybƒõ p≈ôi komunikaci s API. Zkontrolujte konzoli pro v√≠ce detail≈Ø.</p>';
            } finally {
                button.disabled = false;
            }
        }
        
        function updateHistoryUI(type) {
            const counter = document.getElementById(`${type}-history-counter`);
            const prevBtn = document.getElementById(`${type}-prev`);
            const nextBtn = document.getElementById(`${type}-next`);
            
            const history = histories[type];
            const currentIndex = currentIndices[type];

            counter.textContent = `${history.length > 0 ? currentIndex + 1 : 0} / ${history.length}`;
            prevBtn.disabled = currentIndex <= 0;
            nextBtn.disabled = currentIndex >= history.length - 1;
        }

        function navigateHistory(type, direction) {
            const history = histories[type];
            let currentIndex = currentIndices[type];

            currentIndex += direction;

            if (currentIndex >= 0 && currentIndex < history.length) {
                currentIndices[type] = currentIndex;
                const historyEntry = history[currentIndex];
                document.getElementById(`${type}-output`).innerHTML = historyEntry.html;
                
                const contextInputId = {
                    'adventure': 'adventure-context-input',
                    'npc': 'npc-context-input',
                    'ship': 'ship-context-input'
                }[type];
                if (contextInputId) {
                    document.getElementById(contextInputId).value = historyEntry.context || '';
                }

                updateHistoryUI(type);
            }
        }

        // --- Generator Setup ---
        const adventureTypeSelect = document.getElementById('adventure-type-select');
        starfinderData.adventureTypes.forEach(type => {
            const option = document.createElement('option');
            option.value = type.name;
            option.textContent = type.name;
            adventureTypeSelect.appendChild(option);
        });
        
        document.getElementById('save-adventure-btn').addEventListener('click', () => {
            const outputDiv = document.getElementById('adventure-output');
            const plainTextContent = outputDiv.innerText;
            const name = sanitizeForFilename(extractName(outputDiv.innerHTML, 'adventure', document.getElementById('adventure-context-input')));
            const filename = `SF2eGen_pribeh_${getFormattedDate()}_${name}.txt`;
            downloadText(filename, plainTextContent);
        });

        document.getElementById('save-npc-btn').addEventListener('click', () => {
            const outputDiv = document.getElementById('npc-output');
            const plainTextContent = outputDiv.innerText;
            const name = sanitizeForFilename(extractName(outputDiv.innerHTML, 'npc', document.getElementById('npc-context-input')));
            const filename = `SF2eGen_charakter_${getFormattedDate()}_${name}.txt`;
            downloadText(filename, plainTextContent);
        });

        document.getElementById('save-ship-btn').addEventListener('click', () => {
            const outputDiv = document.getElementById('ship-output');
            const plainTextContent = outputDiv.innerText;
            const name = sanitizeForFilename(extractName(outputDiv.innerHTML, 'ship', document.getElementById('ship-context-input')));
            const filename = `SF2eGen_lod_${getFormattedDate()}_${name}.txt`;
            downloadText(filename, plainTextContent);
        });

        document.getElementById('generate-adventure-hook').addEventListener('click', e => {
            const type = adventureTypeSelect.value;
            const userContext = document.getElementById('adventure-context-input').value.trim();
            const prompt = `Vytvo≈ô detailn√≠ n√°mƒõt na dobrodru≈æstv√≠ pro hru Starfinder. Typ dobrodru≈æstv√≠ je "${type}". ${userContext ? `Zohledni tento u≈æivatelsk√Ω n√°mƒõt: "${userContext}".` : ''} Odpovƒõƒè mus√≠ b√Ωt v ƒçe≈°tinƒõ. Zahr≈à n√°sleduj√≠c√≠ sekce s nadpisy: ### Z√°kladn√≠ z√°pletka, ### Kl√≠ƒçov√© lokace, ### Hlavn√≠ konflikt, ### Mo≈æn√Ω zvrat. Ka≈æd√° sekce by mƒõla b√Ωt rozeps√°na alespo≈à na 2-3 vƒõty.`;
            callGeminiAPI(prompt, userContext, document.getElementById('adventure-output'), e.target, 'adventure');
        });

        document.getElementById('generate-npc').addEventListener('click', e => {
            const userContext = document.getElementById('npc-context-input').value.trim();
            const prompt = `Vytvo≈ô detailn√≠ popis NPC postavy pro hru Starfinder. ${userContext ? `Postava by mƒõla zapadat do kontextu: "${userContext}".` : ''} Odpovƒõƒè mus√≠ b√Ωt v ƒçe≈°tinƒõ. Zahr≈à n√°sleduj√≠c√≠ sekce s nadpisy: ### Jm√©no a koncept, ### Vzhled a chov√°n√≠, ### Motivace a c√≠le, ### Tajemstv√≠ nebo h√°ƒçek. Ka≈æd√° sekce by mƒõla b√Ωt rozeps√°na.`;
            callGeminiAPI(prompt, userContext, document.getElementById('npc-output'), e.target, 'npc');
        });

        document.getElementById('generate-ship-name').addEventListener('click', e => {
            const type = document.getElementById('ship-type-select').value;
            const userContext = document.getElementById('ship-context-input').value.trim();
            const prompt = `Vytvo≈ô 5 kreativn√≠ch jmen pro hvƒõzdnou loƒè typu "${type}" ve svƒõtƒõ Starfinder. ${userContext ? `Zohledni tento kontext: "${userContext}".` : ''} Pro ka≈æd√© jm√©no p≈ôidej kr√°tkou, jedno- a≈æ dvouvƒõtnou fiktivn√≠ historii nebo charakteristiku. Odpovƒõƒè mus√≠ b√Ωt v ƒçe≈°tinƒõ. Form√°tuj jako seznam s tuƒçn√Ωmi n√°zvy lod√≠.`;
            callGeminiAPI(prompt, userContext, document.getElementById('ship-output'), e.target, 'ship');
        });

        // History navigation event listeners
        document.getElementById('adventure-prev').addEventListener('click', () => navigateHistory('adventure', -1));
        document.getElementById('adventure-next').addEventListener('click', () => navigateHistory('adventure', 1));
        document.getElementById('npc-prev').addEventListener('click', () => navigateHistory('npc', -1));
        document.getElementById('npc-next').addEventListener('click', () => navigateHistory('npc', 1));
        document.getElementById('ship-prev').addEventListener('click', () => navigateHistory('ship', -1));
        document.getElementById('ship-next').addEventListener('click', () => navigateHistory('ship', 1));


        // --- Initial Load ---
        renderArchetypeCards();
        renderSimpleCards(starfinderData.adventureTypes, 'adventures-tab', 'adventure');
        renderSimpleCards(starfinderData.locations, 'locations-tab', 'location');
        renderSimpleCards(starfinderData.factions, 'factions-tab', 'faction');
        renderDetailedCards(starfinderData.ancestries, 'ancestries-tab', 'ancestry', renderRaceDetails);
        renderDetailedCards(starfinderData.classes, 'classes-tab', 'class', renderClassDetails);
        
        document.getElementById('generate-adventure-hook').click();
        document.getElementById('generate-npc').click();
        document.getElementById('generate-ship-name').click();

        switchTab('generators-tab');
    });
    </script>
</body>
</html>
